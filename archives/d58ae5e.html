<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="referrer" content="no-referrer">
  <meta name="google-site-verification" content="d9AYrxkYK5UHR01Tg1YU-rFek8B4Iv8QJ-2l0wKP9NE">
  <link rel="shortcut icon" href="https://zhihui.gold/images/head.ico">

  
  <title>Ubuntu系统备份方式记录 | 浅梦未央のBLOG</title>
  
  

  

  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <!-- meta -->
  

  <div class="loading"><div id="loader"></div></div>
  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.1/css/all.min.css">
  
  <link rel="stylesheet" href="/">

  

  
    <link rel="stylesheet" href="/style.css">
  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>
  
  <script src="https://cdn.jsdelivr.net/npm/bluebird@3/js/browser/bluebird.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/whatwg-fetch@2.0.3/fetch.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
  <script type="text/javascript" src="/js/global-hot-data.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/pjax/pjax.js"></script>

  <link href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>
  
  <script>
    fetch('https://v1.hitokoto.cn/?c=a')
      .then(function (res){
        return res.json();
      })
      .then(function (data) {
        var h_content = document.getElementById('hitokoto-content');
        var h_from = document.getElementById('hitokoto-from');
        h_content.innerText = data.hitokoto; 
        h_from.innerText = "——" + data.from; 
      })
      .catch(function (err) {
        console.error(err);
      })
  </script>

  	<!-- Global site tag (gtag.js) - Google Analytics -->
  	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-150421519-2"></script>
  	<script>
  	window.dataLayer = window.dataLayer || [];
  	function gtag(){dataLayer.push(arguments);}
  	gtag('js', new Date());
	gtag('config', 'UA-150421519-2');
	</script>

  
  
  
</head>
<body>
  
  
  <div class="cover-wrapper">
    <cover class='cover post half'>
      
        <!--
 * @Author: sunshine
 * @Date: 1970-01-01 08:00:00
 * @Description: 
 -->

  <h1 class='title'>浅梦未央のBLOG</h1>


  <div class="m_search">
    <form name="searchform" class="form u-search-form">
      <input type="text" class="input u-search-input" placeholder="" />
      <i class="icon fas fa-search fa-fw"></i>
    </form>
  </div>

<div class='menu navgation'>
  <ul class='h-list'>
    
      
        <li>
          <a class="nav home" href="/"
            
            
            id="home">
            <i class='fas fa-home fa-fw'></i>&nbsp;主页
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/friends/"
            
              rel="nofollow"
            
            
            id="friends">
            <i class='fas fa-link fa-fw'></i>&nbsp;友链
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/about/"
            
              rel="nofollow"
            
            
            id="about">
            <i class='fas fa-info-circle fa-fw'></i>&nbsp;关于
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/message"
            
            
            id="message">
            <i class='fas fa-comment fa-fw'></i>&nbsp;留言板
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/lab/"
            
              rel="nofollow"
            
            
            id="lab">
            <i class='fas fa-fire fa-fw'></i>&nbsp;实验室
          </a>
        </li>
      
    
  </ul>
</div>

      
    </cover>
    <header class="l_header pure">
  <div id="loading-bar-wrapper">
    <div id="loading-bar" class="pure"></div>
  </div>

	<div class='wrapper'>
		<div class="nav-main container container--flex">
      <a class="logo flat-box" href='/' >
        
          浅梦未央のBLOG
        
      </a>
			<div class='menu navgation'>
				<ul class='h-list'>
          
  					
  						<li>
								<a class="nav flat-box" href="/"
                  
                  
                  id="home">
									<i class='fas fa-home fa-fw'></i>&nbsp;主页
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/friends/"
                  
                    rel="nofollow"
                  
                  
                  id="friends">
									<i class='fas fa-link fa-fw'></i>&nbsp;友链
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/about/"
                  
                    rel="nofollow"
                  
                  
                  id="about">
									<i class='fas fa-info-circle fa-fw'></i>&nbsp;关于
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/message"
                  
                  
                  id="message">
									<i class='fas fa-comment fa-fw'></i>&nbsp;留言板
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/lab/"
                  
                    rel="nofollow"
                  
                  
                  id="lab">
									<i class='fas fa-fire fa-fw'></i>&nbsp;实验室
								</a>
							</li>
      			
      		
				</ul>
			</div>

			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="搜索" />
						<i class="icon fas fa-search fa-fw"></i>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a class="fas fa-search fa-fw" href='javascript:void(0)'></a></li>
				
				<li class='s-menu'><a class="fas fa-bars fa-fw" href='javascript:void(0)'></a></li>
			</ul>
		</div>

		<div class='nav-sub container container--flex'>
			<a class="logo flat-box"></a>
			<ul class='switcher h-list'>
				<li class='s-comment'><a class="flat-btn fas fa-comments fa-fw" href='javascript:void(0)'></a></li>
        
          <li class='s-toc'><a class="flat-btn fas fa-list fa-fw" href='javascript:void(0)'></a></li>
        
			</ul>
		</div>
	</div>
</header>
	<aside class="menu-phone">
    <header>
		<nav class="menu navgation">
      <ul>
        
          
            <li>
							<a class="nav flat-box" href="/"
                
                
                id="home">
								<i class='fas fa-clock fa-fw'></i>&nbsp;近期文章
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/blog/archives/"
                
                  rel="nofollow"
                
                
                id="blogarchives">
								<i class='fas fa-archive fa-fw'></i>&nbsp;文章归档
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/projects/"
                
                
                id="projects">
								<i class='fas fa-code-branch fa-fw'></i>&nbsp;开源项目
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/friends/"
                
                  rel="nofollow"
                
                
                id="friends">
								<i class='fas fa-link fa-fw'></i>&nbsp;我的友链
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="https://xaoxuu.com/wiki/material-x/"
                
                  rel="nofollow"
                
                
                id="https:xaoxuu.comwikimaterial-x">
								<i class='fas fa-book fa-fw'></i>&nbsp;主题文档
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/about/"
                
                  rel="nofollow"
                
                
                id="about">
								<i class='fas fa-info-circle fa-fw'></i>&nbsp;关于小站
							</a>
            </li>
          
       
      </ul>
		</nav>
    </header>
	</aside>
<script>setLoadingBarProgress(40);</script>

  </div>


  <div class="l_body">
    <div class='body-wrapper'>
      <div class='l_main'>
  

  
    <article id="post" class="post white-box article-type-post" itemscope itemprop="blogPost">
      


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  
    <h1 class="title">
      <a href="/archives/d58ae5e.html">
        Ubuntu系统备份方式记录
      </a>
    </h1>
  


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    <a href="https://zhihui.gold" rel="nofollow">
      
        <i class="fas fa-user" aria-hidden="true"></i>
      
      <p>Sunshine</p>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2020-04-04</p>
  </a>
</div>

          
        
          
            

          
        
          
            
  


          
        
          
            

          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


      <section class="article typo">
        <div class="article-entry" itemprop="articleBody">
          <p>传说中的“有备无患”</p>
<p><a href="https://cdn.jsdelivr.net/gh/Sunshine-0215/CDN_Personalblog_202001@4.0/200404/artical_200404_cover.png" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/Sunshine-0215/CDN_Personalblog_202001@4.0/200404/artical_200404_cover.png" alt="img"></a></p>
<a id="more"></a>
<p>先秦·左丘明《左传·襄公十一年》：“《书》曰：“居安思危。思则有备，有备则无患。”</p>
<p>在使用Ubuntu系统的过程中，由于系统的可定制性太高，以至于在使用系统的过程中容易对系统造成一些损坏或者错误的设置(?)。在遇到一些无法修复的系统问题时，往往会选择重装系统，可是重装系统以后，所有的软件、系统设置、美化设置全部都要重新来一遍</p>
<p>不想重装系统的话，还有一种办法就是对系统进行备份，经常性地对系统进行备份也可以避免重装系统后重新做系统的所有设置</p>
<h2 id="分清楚硬盘分区情况"><a href="#分清楚硬盘分区情况" class="headerlink" title="分清楚硬盘分区情况"></a>分清楚硬盘分区情况</h2><p>在对分区进行备份之前，首先我们要搞清楚Ubuntu备份的操作做了什么</p>
<p>Linux系统的特点是不对文件和目录(文件夹)进行区分，文件是文件，目录也是文件，所以我们可以对整个分区进行压缩打包，打包成一个独立的文件存放在硬盘上的某个地方，在需要还原的时候再见这个压缩包解压覆盖到相对应的分区位置即可</p>
<p>因为这种备份操作的特性，所以我们需要先搞清楚自己硬盘的分区情况，对每个分区进行独立的备份</p>
<p>在安装Ubuntu系统的时候，所有用户都会经过分区的操作，此时系统会决定哪些目录会占用独立的分区，我们首先要通过各种方法拿到这种分区划分</p>
<h4 id="通过任务管理器查看"><a href="#通过任务管理器查看" class="headerlink" title="通过任务管理器查看"></a>通过任务管理器查看</h4><p>这是最直接最快捷的方法，适用于一切用户，即使你完全不会使用终端命令</p>
<p>在应用中心打开系统监视器，切换到<code>File Systems</code>，即可查看所有挂载的文件分区</p>
<p><a href="https://cdn.jsdelivr.net/gh/Sunshine-0215/CDN_Personalblog_202001@4.1/200404/System_Monitor.png" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/Sunshine-0215/CDN_Personalblog_202001@4.1/200404/System_Monitor.png" alt="file systems"></a></p>
<p>举个例子，上图是作者机器上的系统监视器给出的信息，从中我们可以看出作者的机器上一共挂载3种分区</p>
<blockquote>
<ul>
<li>系统引导分区 分区类型是vfat，在Windows下是fat32</li>
<li>Linux分区    分区类型是ext2/ext3/ext4，在Windows下一般不可见(笑</li>
<li>其他数据分区 分区类型是fuseblk，在Windows下是ntfs</li>
</ul>
</blockquote>
<p>我们需要备份的是几个在Windows下不可见的Linux分区，在这个例子中也就是</p>
<blockquote>
<ul>
<li>/      根分区，挂在位置在sda7</li>
<li>/boot  启动分区，挂载位置在sda6</li>
<li>/home 主分区，挂载位置在sdc5</li>
</ul>
</blockquote>
<h4 id="通过系统自带的硬盘工具查看"><a href="#通过系统自带的硬盘工具查看" class="headerlink" title="通过系统自带的硬盘工具查看"></a>通过系统自带的硬盘工具查看</h4><p>当然了，条条大路通罗马，除了使用系统监视器以外，我们也可以使用Ubuntu系统自带的硬盘工具查看分区情况；不过这个工具隐藏的位置比较深入，在应用中心中有一个<code>Utilities</code>文件夹，在这个文件夹中可以找到<code>Disk</code>工具</p>
<p><img src="https://cdn.jsdelivr.net/gh/Sunshine-0215/CDN_Personalblog_202001@4.1/200404/disk.png" alt="disk"></p>
<p>从作者机器上这个工具的截图看，当前选中的分区位于第一块硬盘（sda，一块240G的固态硬盘）的末尾，分区挂载在dev/sda7，以根分区文件系统的形式挂载(Filesystem Root)</p>
<p>这个工具给出的信息比较多，当然对新手也更不友好，不过毕竟是图形界面，到处看看还是能看出点门道来的</p>
<h4 id="通过fstab文件查看"><a href="#通过fstab文件查看" class="headerlink" title="通过fstab文件查看"></a>通过fstab文件查看</h4><p>在Ubuntu系统中，如果想要开机自动挂载某个分区，则需要在fstab文件中写出该分区在硬盘上的位置、想要挂载到的位置，挂载形式，开机是否进行自动检查等参数，Linux分区的挂载同样需要这个文件，我们可以通过这个文件看出我们所需要的信息</p>
<p>在终端中输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gedit /etc/fstab</span><br></pre></td></tr></table></figure>
<p>fstab文件属于系统文件，需要超级用户权限才能修改，如果需要修改，需要在命令前面添加sudo前缀临时获得权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/fstab</span><br></pre></td></tr></table></figure>
<p>警示！！！不建议在没有备份的情况下修改fstab文件的内容，Ubuntu系统在开机时如果挂载到了错误的分区，会直接进入Recovery模式，无法正常开机，需要修改成正确的fstab文件才能开机</p>
<p>备份fstab文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /etc/fstab /etc/fstab.back</span><br></pre></td></tr></table></figure>
<p>fstab文件内容如下</p>
<p><a href="https://cdn.jsdelivr.net/gh/Sunshine-0215/CDN_Personalblog_202001@4.1/200404/fstab.png" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/Sunshine-0215/CDN_Personalblog_202001@4.1/200404/fstab.png" alt="fstab"></a></p>
<p>从fstab文件中我们可以得到与系统监视器一样的结论，不过开机后再挂载的移动设备不会包含在fstab文件中</p>
<h4 id="使用终端命令查看"><a href="#使用终端命令查看" class="headerlink" title="使用终端命令查看"></a>使用终端命令查看</h4><p>最后一种方法，怎么能少得了万能的命令行呢，只给图形界面的操作方法，你瞧谁不起呢！</p>
<p>在Ubuntu终端中查看分区信息有多少种方法，这里只介绍最常用的一种，使用<code>fdisk</code>命令查看</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo fdisk -l</span><br></pre></td></tr></table></figure>
<p>命令行会输出一大堆信息，其中会有我们所需要的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">Disk /dev/sda: 223.6 GiB, 240057409536 bytes, 468862128 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disklabel type: gpt</span><br><span class="line">Disk identifier: 0F20B151-2873-439C-845D-E38042C81A30</span><br><span class="line"></span><br><span class="line">Device         Start       End   Sectors   Size Type</span><br><span class="line">/dev/sda1       2048   1023999   1021952   499M Windows recovery environment</span><br><span class="line">/dev/sda2    1024000   1228799    204800   100M EFI System</span><br><span class="line">/dev/sda3    1228800   1261567     32768    16M Microsoft reserved</span><br><span class="line">/dev/sda4    1261568 247818695 246557128 117.6G Microsoft basic data</span><br><span class="line">/dev/sda5  247818696 249571327   1752632 855.8M Windows recovery environment</span><br><span class="line">/dev/sda6  249571328 253571071   3999744   1.9G Linux filesystem</span><br><span class="line">/dev/sda7  253571072 468860927 215289856 102.7G Linux filesystem</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Disk /dev/sdb: 3.7 TiB, 4000787030016 bytes, 7814037168 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 4096 bytes / 33553920 bytes</span><br><span class="line">Disklabel type: gpt</span><br><span class="line">Disk identifier: 0CFA0E31-5858-9090-8081-828310111213</span><br><span class="line"></span><br><span class="line">Device     Start        End    Sectors  Size Type</span><br><span class="line">/dev/sdb1   2048 7814031231 7814029184  3.7T Microsoft basic data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Disk /dev/sdc: 931.5 GiB, 1000204886016 bytes, 1953525168 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 4096 bytes</span><br><span class="line">I/O size (minimum/optimal): 4096 bytes / 4096 bytes</span><br><span class="line">Disklabel type: gpt</span><br><span class="line">Disk identifier: 0C5204A1-5858-9090-8081-828310111213</span><br><span class="line"></span><br><span class="line">Device          Start        End   Sectors   Size Type</span><br><span class="line">/dev/sdc1   252268696 1075230519 822961824 392.4G Microsoft basic data</span><br><span class="line">/dev/sdc2  1075230520 1411679744 336449225 160.4G Microsoft basic data</span><br><span class="line">/dev/sdc3  1411679808 1726328840 314649033   150G Microsoft basic data</span><br><span class="line">/dev/sdc4  1726328904 1953519137 227190234 108.3G Microsoft basic data</span><br><span class="line">/dev/sdc5        2048  236267519 236265472 112.7G Linux filesystem</span><br><span class="line">/dev/sdc6   236267520  252268543  16001024   7.6G Linux swap</span><br></pre></td></tr></table></figure>
<p>我们只需要看<code>type</code>是<code>Linux filesystem</code>的分区即可，通过上面的信息和分区大小的匹配，可以得出与系统监视器相同的结论</p>
<p>通过条条大路到达罗马后，我们可以得出结论，需要备份的Linux分区有以下三个</p>
<blockquote>
<ul>
<li>/      根分区，挂在位置在sda7，大小是45.0GB</li>
<li>/boot  启动分区，挂载位置在sda6，大小是125.5MB</li>
<li>/home 主分区，挂载位置在sdc5，大小是42.4GB</li>
</ul>
</blockquote>
<h2 id="打包命令的使用"><a href="#打包命令的使用" class="headerlink" title="打包命令的使用"></a>打包命令的使用</h2><p>在Ubuntu下，可使用<code>tar</code>命令对文件和目录创建打包档案。利用这一命令，可以为某一个文件创建档案，也可以将一大堆文件和目录全部打包成一个文件，用户也随时可以向档案中增添或删减文件，这对于档案的储存和管理是非常有用的</p>
<p>可能有细心的读者会发现这其中有一些细微的差别：<code>tar</code>命令只是打包操作，打包操作是不包含压缩这个选项的。没错，打包和压缩是文件管理中分立的两个概念</p>
<blockquote>
<ul>
<li>打包是将一堆文件和目录变成一个总的文件</li>
<li>压缩是将一个大文件通过压缩算法变成一个小文件</li>
</ul>
</blockquote>
<p>为什么要区分这两个概念呢，这源于Linux下的很多压缩程序并不具备打包的功能，他们只能操作单独的文件，所以如果要进行压缩打包，要先使用<code>tar</code>指令打包，再使用<code>gzip</code>或<code>gzip2</code>指令进行压缩</p>
<p><code>tar</code>命令的使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar [required para][optional para][files or directory]</span><br></pre></td></tr></table></figure>
<p>参数含义</p>
<p>必要参数(required para)</p>
<p>-A   新增压缩文件到已存在的压缩<br>-B   设置区块大小<br>-c   建立新的压缩文件<br>-d   记录文件的差别<br>-r    加文件到已经压缩的文件<br>-u   添加改变了和现有的文件到已经存在的压缩文件<br>-x   从压缩的文件中提取文件<br>-t   显示压缩文件的内容<br>-z   使用gzip压缩文件，减少占用空间<br>-j   使用bzip2压缩文件，减少占用空间<br>-Z   支持compress解压文件<br>-v   显示操作过程<br>-l   文件系统边界设置<br>-k   保留原有文件不覆盖<br>-m   保留文件不被覆盖<br>-W   确认压缩文件的正确性<br>-p   用原来的文件权限还原文件</p>
<p>可选参数(optional para)</p>
<p>-b   设置区块数目<br>-C   切换到指定目录<br>-f   指定压缩文件(带路径)，只能作为最后一个参数<br>—help   显示帮助信息<br>—version   显示版本信息<br>—exclude   排除指定目录，不进行备份</p>
<h2 id="进行备份前准备"><a href="#进行备份前准备" class="headerlink" title="进行备份前准备"></a>进行备份前准备</h2><p>备份前需要对系统进行必要的瘦身，因为我们是备份整个系统，所以备份一些不必要的内容会增加空间占用</p>
<p>删除旧版本软件缓存</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get autoclean</span><br></pre></td></tr></table></figure>
<p>清除所有软件缓存</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get clean</span><br></pre></td></tr></table></figure>
<p>清除系统中不再使用的孤立软件(慎用，有可能会将一些依赖删除)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get autoremove</span><br></pre></td></tr></table></figure>
<h2 id="开始备份"><a href="#开始备份" class="headerlink" title="开始备份"></a>开始备份</h2><p>准备工作的最后一步，我们需要寻找一个合适的备份介质，首先这个介质需要有足够大的剩余空间，能够放下整个分区的文件；其次这个位置需要比较安全，而且重装系统的过程中不能被覆盖</p>
<p>建议放在大容量的机械硬盘分区里面或者外置的储存设备，作者使用的就是由机械硬盘盒和台式机机械硬盘组成的外置储存设备</p>
<p><img src="https://cdn.jsdelivr.net/gh/Sunshine-0215/CDN_Personalblog_202001@4.1/200404/disk_table.png" alt="disk table"></p>
<p>首先 打开终端(笑</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+Shift+T</span><br></pre></td></tr></table></figure>
<p>切换到root用户，避免权限问题</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su root</span><br></pre></td></tr></table></figure>
<p>如果是第一次使用root用户的话，需要先设置root账户密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo passwd root</span><br></pre></td></tr></table></figure>
<p>根据提示设置密码并确认密码后，可以登陆root账户</p>
<p>再切换到 / 根目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /</span><br></pre></td></tr></table></figure>
<p>备份系统命令，此处以备份 / 分区为例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar cpzf /media/sunshine/0CFB19510CFB1951/Backup/ubuntu_backup/ubuntu_back_20200309_2031.tgz --exclude=/proc --exclude=-lost+found --exclude=/media --exclude=/mnt --exclude=/home  --exclude=/boot --exclude=run --exclude=tmp /</span><br></pre></td></tr></table></figure>
<p>分析一下这个命令</p>
<h5 id="第一部分"><a href="#第一部分" class="headerlink" title="第一部分"></a>第一部分</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar cpz</span><br></pre></td></tr></table></figure>
<p><code>tar</code>命令和必要参数</p>
<blockquote>
<p>c   新建一个备份文档<br>p   保存权限，并应用到所有文件<br>z   使用gzip压缩备份文档，减少占用空间</p>
</blockquote>
<h5 id="第二部分"><a href="#第二部分" class="headerlink" title="第二部分"></a>第二部分</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f /media/sunshine/0CFB19510CFB1951/Backup/ubuntu_backup/ubuntu_root_backup@`date +%Y-%m-%d`.tgz</span><br></pre></td></tr></table></figure>
<p>可选参数和指定备份文件的目的路径</p>
<blockquote>
<p>f   指定压缩包名称，只能做最后一个参数，后面接文件路径</p>
</blockquote>
<p>文件路径填你的目的路径和压缩包文件名，注意文件后缀是<code>.tgz</code></p>
<p>为了区分不同备份版本，在这条命令中还使用<code>date +%Y-%m-%d</code>命令，调用系统时间作为备份文件的一部分</p>
<p>在3月31日使用该命令时，最终的备份文件名字为<code>ubuntu_root_backup@2020-03-31.tgz</code></p>
<h5 id="第三部分"><a href="#第三部分" class="headerlink" title="第三部分"></a>第三部分</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--exclude=/proc --exclude=/lost+found --exclude=/media --exclude=/mnt --exclude=/tmp --exclude=/run --exclude=/home --exclude=/boot</span><br></pre></td></tr></table></figure>
<p>这里就是使用<code>--exclude</code>参数排除不想备份的文件夹，下面详细说明一下建议排除的文件夹以及他们的作用</p>
<p>/proc        虚拟文件系统，系统运行的每一个进程都会自动在这个目录下面创建一个进程目录。既然是系统自动创建，也就没必要备份的必要了<br>/lost+found   系统发生错误时（比如非法关机），可以在这里找回一些丢失文件<br>/media      多媒体挂载点，像u盘、移动硬盘、机械硬盘上的其他数据分区等都会默认挂载到这个目录下，当然了，用户也可能会自定<br>/mnt        临时挂载点，你可以自己挂载一些文件系统到这里<br>/tmp        临时文件夹，系统的一些临时文件会放在这里<br>/run        系统从启动以来产生的一些信息文件<br>/boot       和系统启动相关的文件，像grub相关文件都放在这里，这个目录很重要<br>/home      用户主目录，存放用户个人文件和应用程序</p>
<h5 id="第四部分"><a href="#第四部分" class="headerlink" title="第四部分"></a>第四部分</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/</span><br></pre></td></tr></table></figure>
<p>这是你希望备份的目录，在这个例子中是根分区</p>
<p>一些提示</p>
<p>以下是几点提示，这几点比较重要，如果忽视则可能导致一些奇怪的错误发生，或是达不到我们需要的备份效果</p>
<ul>
<li>/mmt目录需要排除在外。如果不把/mnt目录排除在外，挂载在/mnt目录上的其他分区也会被备份</li>
<li>/media目录需要排除在外。如果不把/media目录排除在外，挂载在/media目录上的其他分区，比如外置的存储设备也会被备份</li>
<li>任何挂载其他存储设备的目录都需要被排除在外。举例来说，作者的Ubuntu系统中，来自机械硬盘的<code>ntfs</code>数据分区会在开机时自动以<code>fuseblk</code>格式挂载到<code>/home/用户名/Media/</code>中，所以在备份<code>/home</code>目录时，需要排除<code>/Meia</code>目录，否则会将里面挂载的整个机械硬盘的数据备份一遍</li>
<li>切记要排除备份的目的文件本身所在的目录。如上面的例子中，备份文件<code>ubuntu_root_backup@2020-03-31.tgz</code>所在的目录一定要排除，否则会变成我备份我自己，可能会得到一些超出常理的备份结果，嘻嘻</li>
</ul>
<h2 id="还原系统"><a href="#还原系统" class="headerlink" title="还原系统"></a>还原系统</h2><p>备份完之后，万一有一天系统崩溃了，我们需要恢复系统，这时可以通过Ubuntu系统的安装U盘(Lived USB)进入<code>try Ubuntu</code>模式</p>
<p><code>tar</code>还原只能覆盖原有存在的文件，即增量还原的概念</p>
<p>假设备份系统时计算机中有<code>1234</code>这四个文件</p>
<p><img src="https://cdn.jsdelivr.net/gh/Sunshine-0215/CDN_Personalblog_202001@4.1/200404/orgin.png" alt></p>
<p>需要还原系统时，计算机中的文件状态已经变成<code>1234</code>5678`，文件4由于一些原因发生了改变，新增了文件5678</p>
<p><img src="https://cdn.jsdelivr.net/gh/Sunshine-0215/CDN_Personalblog_202001@4.1/200404/change.png" alt></p>
<p>此时若直接使用<code>tar</code>覆盖还原的方式，则计算机中的文件会变为<code>12345678</code>,文件4`被备份存档中的文件4替代，文件5678保留</p>
<p><img src="https://cdn.jsdelivr.net/gh/Sunshine-0215/CDN_Personalblog_202001@4.0/200404/after.png" alt></p>
<p>当然这种情况对于日常使用的文档文件是没有问题的，如果仅对于文档备份则当然可以这么做，但对于包含程序包的备份存档，则会因为依赖变化等问题出现一些错误，所以不建议大家在系统备份中使用覆盖还原</p>
<p>切换到<code>root</code>用户，找到旧Ubuntu系统的根分区所在分区，一般来说，可以在Ubuntu系统的<code>/media</code>目录下面找到，使用<code>rm -rf</code>指令删除整个分区中的文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rm -rf /media/磁盘名称/分区名称</span><br></pre></td></tr></table></figure>
<p>先创建一个临时目录用于挂载原系统的文件系统</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /mnt/origin/sys</span><br></pre></td></tr></table></figure>
<p>将原系统文件系统挂载到临时目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount /dev/分区 /mnt/origin/sys</span><br></pre></td></tr></table></figure>
<p>在临时目录中解压备份档案</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xvpzf /media/myDisk/ubuntu_root_backup@xxxx.tar.gz -C /mnt/sys</span><br></pre></td></tr></table></figure>
<p>解压完成后，记得要将备份时使用<code>--exclude</code>指令排除在外的目录重新创建，否则重启系统后会遇到错误</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /mnt/sys</span><br><span class="line">mkdir proc lost+found media mnt  run tmp</span><br></pre></td></tr></table></figure>
<p>其中，<code>/home</code>目录和<code>/boot</code>目录在这个例子中由于是在另外的分区，删除时不会被覆盖，所以我们也不需要重新创建这两个目录</p>
<p>警示！！！如果在恢复系统的过程中，您修改了硬盘的分区，，各个分区的UUID发生了改变，那么重启系统前一定要根据各个分区的信息重新修改<code>/etc/fstab</code>文件，否则不能开机</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>系统的备份和还原操作对应于每个人的计算机状况不同，受限于分区情况、存储介质挂载情况、使用习惯不相同等差异，有很多种不同的方式方法和解决方案，切不可因循守旧，墨守成规，要根据自身的情况灵活判断和改变</p>

        </div>
        
          


  <section class='meta' id="footer-meta">
	
		<div style="text-align: center; font-size: 20px">来了就留下您的评分吧！</div>
		<div style="text-align: center;" id="wpac-rating">正在加载点赞系统</div>
		<script type="text/javascript">
			wpac_init = window.wpac_init || [];
			wpac_init.push({widget: 'Rating', id: 21085 });
			(function() {
				if ('WIDGETPACK_LOADED' in window) return;
				WIDGETPACK_LOADED = true;
				var mc = document.createElement('script');
				mc.type = 'text/javascript';
				mc.async = true;
				mc.src = 'https://embed.widgetpack.com/widget.js';
				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(mc, s.nextSibling);
			})();
		</script>
		<a href="https://widgetpack.com" class="wpac-cr"></a>
	

    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2020-04-04T00:44:43+08:00">
  <a class='notlink'>
    <i class="fas fa-clock" aria-hidden="true"></i>
    <p>最后更新于 2020年4月4日</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Linux/" rel="nofollow"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;<p>Linux</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Ubuntu/" rel="nofollow"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;<p>Ubuntu</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/备份/" rel="nofollow"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;<p>备份</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/系统维护/" rel="nofollow"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;<p>系统维护</p></a></div>


        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="QQ好友" rel="external nofollow noopener noreferrer"
          
          href="http://connect.qq.com/widget/shareqq/index.html?url=https://zhihui.gold/archives/d58ae5e.html&title=Ubuntu系统备份方式记录 | 浅梦未央のBLOG&summary=传说中的“有备无患”
"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="QQ空间" rel="external nofollow noopener noreferrer"
          
          href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://zhihui.gold/archives/d58ae5e.html&title=Ubuntu系统备份方式记录 | 浅梦未央のBLOG&summary=传说中的“有备无患”
"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title="微博" rel="external nofollow noopener noreferrer"
          
          href="http://service.weibo.com/share/share.php?url=https://zhihui.gold/archives/d58ae5e.html&title=Ubuntu系统备份方式记录 | 浅梦未央のBLOG&summary=传说中的“有备无患”
"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/weibo.png">
          
        </a>
      
    
  </div>
</div>



        
      
	</div>
	
  </section>


        
        
            <div class="prev-next">
                
                
                    <section class="next">
                        <span class="art-item-right" aria-hidden="true">
                            <h6>下一页&nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i></h6>
                            <h4>
                                <a href="/archives/9ca8d389.html" rel="prev" title="Ubuntu常用命令总结之二：系统信息、磁盘操作、用户权限操作、压缩操作">
                                    
                                        Ubuntu常用命令总结之二：系统信息、磁盘操作、用户权限操作、压缩操作
                                    
                                </a>
                            </h4>
                            
                                
                                <h6 class="tags">
                                    <a class="tag" href="/tags/Linux/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>Linux</a> <a class="tag" href="/tags/Ubuntu/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>Ubuntu</a> <a class="tag" href="/tags/学习/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>学习</a> <a class="tag" href="/tags/备份/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>备份</a>
                                </h6>
                            
                        </span>
                    </section>
                
            </div>
        
      </section>
    </article>
  

  
    <!-- 显示推荐文章和评论 -->



  <article class="post white-box comments">
    <section class="article typo">
      <h4><i class="fas fa-comments fa-fw" aria-hidden="true"></i>&nbsp;评论</h4>
      
      
      
        <section id="comments">
          <div id="gitalk-container"></div>
        </section>
      
      
    </section>
  </article>


  




<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->



  <script>
    window.subData = {
      title: 'Ubuntu系统备份方式记录',
      tools: true
    }
  </script>


</div>
<aside class='l_side'>
  
    
    
      
        
          
          
            <!--
 * @Author: sunshine
 * @Date: 1970-01-01 08:00:00
 * @Description: 
 -->
<section class='widget author'>
  <div class='content pure'>
    
      <div class='avatar'>
        <img class='avatar' src='https://cdn.jsdelivr.net/gh/Sunshine-0215/CDN-for-Personalblog@2.0/pictures_source_file/Profile/profile_sunshine.jpg'/>
      </div>
    
    
    <center>
      <div id="name">
        <p><big><big>&piv;&sect;&spades;&nbsp;&nbsp;&nbsp;浅梦未央&nbsp;&nbsp;&nbsp;&spades;&sect;&piv;</big></big></p>
      </div>
    </center>
    </center>
    <center>
      <div id="binft"></span></div>
      <script>
          var binft = function (r) {
            function t() {
              return b[Math.floor(Math.random() * b.length)]
            }  
            function e() {
              return String.fromCharCode(94 * Math.random() + 33)
            }
            function n(r) {
              for (var n = document.createDocumentFragment(), i = 0; r > i; i++) {
                var l = document.createElement("span");
                l.textContent = e(), l.style.color = t(), n.appendChild(l)
              }
              return n
            }
            function i() {
              var t = o[c.skillI];
              c.step ? c.step-- : (c.step = g, c.prefixP < l.length ? (c.prefixP >= 0 && (c.text += l[c.prefixP]), c.prefixP++) : "forward" === c.direction ? c.skillP < t.length ? (c.text += t[c.skillP], c.skillP++) : c.delay ? c.delay-- : (c.direction = "backward", c.delay = a) : c.skillP > 0 ? (c.text = c.text.slice(0, -1), c.skillP--) : (c.skillI = (c.skillI + 1) % o.length, c.direction = "forward")), r.textContent = c.text, r.appendChild(n(c.prefixP < l.length ? Math.min(s, s + c.prefixP) : Math.min(s, t.length - c.skillP))), setTimeout(i, d)
            }
            var l = "",
            o = ["All rivers run into the sea", "Life is real, life is earnest", "Sow nothing, reap nothig", "A young idler, an old beggar", "Bad times make a good man", "No one can call back yesterday", "Not to advance is to go back", "No cross, no crown", "No pains, no gains", "Never say die"].map(function (r) {
            return r + ""
            }),
            a = 2,
            g = 1,
            s = 5,
            d = 75,
            b = ["rgb(110,64,170)", "rgb(150,61,179)", "rgb(191,60,175)", "rgb(228,65,157)", "rgb(254,75,131)", "rgb(255,94,99)", "rgb(255,120,71)", "rgb(251,150,51)", "rgb(226,183,47)", "rgb(198,214,60)", "rgb(175,240,91)", "rgb(127,246,88)", "rgb(82,246,103)", "rgb(48,239,130)", "rgb(29,223,163)", "rgb(26,199,194)", "rgb(35,171,216)", "rgb(54,140,225)", "rgb(76,110,219)", "rgb(96,84,200)"],
            c = {
              text: "",
              prefixP: -s,
              skillI: 0,
              skillP: 0,
              direction: "forward",
              delay: a,
              step: g
            };
            i()
            };
            binft(document.getElementById('binft'));
        </script>
    </center>
    
      <div class="social-wrapper">
        
          
            <a href="https://github.com/Sunshine-0215"
              class="social fab fa-github flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="mailto:sunshine021599@gmail.com"
              class="social fas fa-envelope flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://music.163.com/#/user/home?id=424194725"
              class="social fas fa-headphones-alt flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://www.zhihu.com/people/qian-meng-wei-yang-87-60"
              class="social fab fa-zhihu flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://space.bilibili.com/199206501"
              class="social fab fa-bootstrap flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
      </div>
    
  </div>
</section>

          
        
      
        
          
          
            
  <section class='widget toc-wrapper'>
    
<header class='pure'>
  <div><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;本文目录</div>
  
    <div class='wrapper'><a class="s-toc rightBtn" rel="external nofollow noopener noreferrer" href="javascript:void(0)"><i class="fas fa-thumbtack fa-fw"></i></a></div>
  
</header>

    <div class='content pure'>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#分清楚硬盘分区情况"><span class="toc-text">分清楚硬盘分区情况</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#通过任务管理器查看"><span class="toc-text">通过任务管理器查看</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#通过系统自带的硬盘工具查看"><span class="toc-text">通过系统自带的硬盘工具查看</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#通过fstab文件查看"><span class="toc-text">通过fstab文件查看</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用终端命令查看"><span class="toc-text">使用终端命令查看</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#打包命令的使用"><span class="toc-text">打包命令的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#进行备份前准备"><span class="toc-text">进行备份前准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#开始备份"><span class="toc-text">开始备份</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#第一部分"><span class="toc-text">第一部分</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#第二部分"><span class="toc-text">第二部分</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#第三部分"><span class="toc-text">第三部分</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#第四部分"><span class="toc-text">第四部分</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#还原系统"><span class="toc-text">还原系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-text">总结</span></a></li></ol>
    </div>
  </section>


          
        
      
        
          
          
            <section class='widget grid'>
  
<header class='pure'>
  <div><i class="fas fa-sign fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;站内导航</div>
  
</header>

  <div class='content pure'>
    <ul class="grid navgation">
      
        <li><a class="flat-box" title="/archives/" href="/archives/"
          
            rel="nofollow"
          
          
          id="archives">
          
            <i class="fas fa-archive fa-fw" aria-hidden="true"></i>
          
          文章归档
        </a></li>
      
        <li><a class="flat-box" title="/friends/" href="/friends/"
          
            rel="nofollow"
          
          
          id="friends">
          
            <i class="fas fa-link fa-fw" aria-hidden="true"></i>
          
          我的友链
        </a></li>
      
        <li><a class="flat-box" title="/404.html" href="/404.html"
          
            rel="nofollow"
          
          
          id="404.html">
          
            <i class="fas fas fa-cloud-download-alt fa-fw" aria-hidden="true"></i>
          
          下载管理
        </a></li>
      
        <li><a class="flat-box" title="/archives/9284d20.html" href="/archives/9284d20.html"
          
            rel="nofollow"
          
          
          id="archives9284d20.html">
          
            <i class="fas fa-calendar-check fa-fw" aria-hidden="true"></i>
          
          更新计划
        </a></li>
      
        <li><a class="flat-box" title="/404.html" href="/404.html"
          
            rel="nofollow"
          
          
          id="404.html">
          
            <i class="fas fas fa-thermometer-three-quarters fa-fw" aria-hidden="true"></i>
          
          访问统计
        </a></li>
      
        <li><a class="flat-box" title="/about/" href="/about/"
          
            rel="nofollow"
          
          
          id="about">
          
            <i class="fas fa-info-circle fa-fw" aria-hidden="true"></i>
          
          关于小站
        </a></li>
      
    </ul>
  </div>
</section>

          
        
      
        
          
          
            

          
        
      
        
          
          
            
  <section class='widget tagcloud'>
    
<header class='pure'>
  <div><i class="fas fa-fire fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;热门标签</div>
  
</header>

    <div class='content pure'>
      <a href="/tags/Linux/" style="font-size: 24px; color: #555">Linux</a> <a href="/tags/QQ/" style="font-size: 14px; color: #999">QQ</a> <a href="/tags/TIM/" style="font-size: 14px; color: #999">TIM</a> <a href="/tags/Ubuntu/" style="font-size: 24px; color: #555">Ubuntu</a> <a href="/tags/Wehcat/" style="font-size: 14px; color: #999">Wehcat</a> <a href="/tags/command/" style="font-size: 14px; color: #999">command</a> <a href="/tags/deepin-wine/" style="font-size: 14px; color: #999">deepin-wine</a> <a href="/tags/备份/" style="font-size: 19px; color: #777">备份</a> <a href="/tags/学习/" style="font-size: 19px; color: #777">学习</a> <a href="/tags/更新/" style="font-size: 14px; color: #999">更新</a> <a href="/tags/系统维护/" style="font-size: 14px; color: #999">系统维护</a>
    </div>
  </section>

          
        
      
        
          
          
            <section class="widget latest_comments">
    <div class="body_hot_comment" id="body_hot_comment"></div>
</section>
          
        
      
        
          
          
            <section class='widget plain'>
  
<header class='pure'>
  <div><i class="fas fa-bullhorn fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;公告</div>
  
</header>

  <div class='content pure'>
    <p><a href="https://github.com/Sunshine-0215/Sunshine-0215.github.io">博客源代码</a>已经公开，如果访问缓慢，可以到<a href="">镜像网站</a></p>

  </div>
</section>

          
        
      
        
          
          
            <!--
 * @Author: sunshine
 * @Date: 1970-01-01 08:00:00
 * @Description: 
 -->
<section class='widget hitokoto'>

<header class='pure'>
  <div><i class="fas fa-code fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;一言</div>
  
</header>
<div>
    <div class="content pure">
    <div>
        <!-- <div style="display: table-cell;vertical-align: top; color:black;font-size:20px;font-family:'Source Sans Pro',serif;font-weight:bold;text-align:left;">“</div> -->
        <div style="display: table-cell;text-align: left; vertical-align: middle; font-size:18px; text-indent: 2em; padding: 0.8em 0.2em 1em 0.2em"><b><span style="color:#FF5B33;"><span id="hitokoto-content"></span></span></b></div>
        <!-- <div style="display: table-cell; vertical-align: bottom; color:black;font-size:20px;font-family:'Source Sans Pro',serif;font-weight:bold;text-align:left;">”</div> -->
    </div>
    <div style="text-align: right; font-size: 0.8em; color: #555555;" id="hitokoto-from"></div>
</section>
          
        
      
    

  
</aside>
<!--
 * @Author: sunshine
 * @Date: 1970-01-01 08:00:00
 * @Description: 
 -->
<footer id="footer" class="clearfix">
  
    <div class="footer">
      <p>Copyright 浅梦未央@2020</p>

    </div>
    <br>
  
  
    <div class="social-wrapper">
      
        
          <a href="https://github.com/Sunshine-0215"
            class="social fab fa-github flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="mailto:sunshine021599@gmail.com"
            class="social fas fa-envelope flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://music.163.com/#/user/home?id=424194725"
            class="social fas fa-headphones-alt flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://www.zhihu.com/people/qian-meng-wei-yang-87-60"
            class="social fab fa-zhihu flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://space.bilibili.com/199206501"
            class="social fab fa-bootstrap flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
    </div>
  
  <span id="dateTimes">载入天数时间</span>
  <script>
    var now = new Date();
    function createtime(){
      var grt = new Date("01/25/2020 12:00:00"); //建站日期  月日年时分秒
      now.setTime(now.getTime() + 250);
      days = (now - grt) / 1000 / 60 / 60 / 24,
      dnum = Math.floor(days);
      hours = (now - grt) / 1000 / 60 / 60 - (24 * dnum);
      hnum = Math.floor(hours);
      if(String(hnum).length == 1){
        hnum = "0" + hnum;
      }
      document.getElementById("dateTimes").innerHTML = "本站已安全运行" + dnum + "天" + hnum + "小时";
    }
    setInterval("createtime()",250);
  </script>
  <br>
  <div><p>博客内容遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
  <div>
    本站使用
    <a href="https://xaoxuu.com/wiki/material-x/" target="_blank" class="codename">Material X</a>
    作为主题
    
    。
  </div>
</footer>
<script>setLoadingBarProgress(80);</script>

<!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": {
      preferredFont: "TeX",
      availableFonts: ["STIX","TeX"],
      linebreaks: { automatic:true },
      EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
      inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
      processEscapes: true,
      ignoreClass: "tex2jax_ignore|dno",
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: { autoNumber: "AMS" },
      noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFF", mathsize: "90%" } },
      Macros: { href: "{}" }
    },
    messageStyle: "none"
  });
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += (all[i].SourceElement().parentNode.className ? ' ' : '') + 'has-jax';
    }
  });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
  src="https://cdn.jsdelivr.net/npm/mathjax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>

  <script>
    var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
    var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
    var ALGOLIA_API_KEY = "";
    var ALGOLIA_APP_ID = "";
    var ALGOLIA_INDEX_NAME = "";
    var AZURE_SERVICE_NAME = "";
    var AZURE_INDEX_NAME = "";
    var AZURE_QUERY_KEY = "";
    var BAIDU_API_ID = "";
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/"||"/";
    if(!ROOT.endsWith('/'))ROOT += '/';
  </script>

<script src="//instant.page/1.2.2" type="module" integrity="sha384-2xV8M5griQmzyiY3CDqh1dn4z3llDVqZDqzjzcY+jCBCk/a5fXJmuZ/40JJAPeoU"></script>



  <script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>
  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>



  <!-- fastclick -->
  <script src="https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      FastClick.attach(document.body)
    }, false)
  </script>



  
  
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js"></script>
    <script type="text/javascript">
      $(function(){
        if ('') {
          $('').backstretch(
          ["https://i.loli.net/2020/03/26/lpfeEmRaBwxYkCZ.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        } else {
          $.backstretch(
          ["https://i.loli.net/2020/03/26/lpfeEmRaBwxYkCZ.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        }
      });
    </script>
  







  <link rel="stylesheet" href="/js/gitalk.css">
  <script src="/js/gitalk.js"></script>
  <script type="text/javascript">
    var gitalk = new Gitalk({
		clientID: '3834d471f8d5bcc2124c',
		clientSecret: '65eba0180c59c88aaeada1446ed6e55e73ed1861',
		accessToken: '36159b9ee938e02ee4f766fb299f885b4e477dd7',
		repo: 'Sunshine-0215.github.io',
		owner: 'Sunshine-0215',
		admin: ['Sunshine-0215'],
		id: location.pathname,
		language: 'zh-CN',
		distractionFreeMode: ''
	});
	gitalk.render('gitalk-container');
  </script>





  <script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-material-x@19.8/js/app.js"></script>


  <script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-material-x@19.8/js/search.js"></script>




<!-- 复制 -->
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  let COPY_SUCCESS = "复制成功";
  let COPY_FAILURE = "复制失败";
  /*页面载入完成后，创建复制按钮*/
  !function (e, t, a) {
    /* code */
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '  <i class="fa fa-copy"></i><span>复制</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });

      clipboard.on('success', function(e) {
        //您可以加入成功提示
        console.info('Action:', e.action);
        console.info('Text:', e.text);
        console.info('Trigger:', e.trigger);
        success_prompt(COPY_SUCCESS);
        e.clearSelection();
      });
      clipboard.on('error', function(e) {
        //您可以加入失败提示
        console.error('Action:', e.action);
        console.error('Trigger:', e.trigger);
        fail_prompt(COPY_FAILURE);
      });
    }
    initCopyCode();

  }(window, document);

  /**
   * 弹出式提示框，默认1.5秒自动消失
   * @param message 提示信息
   * @param style 提示样式，有alert-success、alert-danger、alert-warning、alert-info
   * @param time 消失时间
   */
  var prompt = function (message, style, time)
  {
      style = (style === undefined) ? 'alert-success' : style;
      time = (time === undefined) ? 1500 : time*1000;
      $('<div>')
          .appendTo('body')
          .addClass('alert ' + style)
          .html(message)
          .show()
          .delay(time)
          .fadeOut();
  };

  // 成功提示
  var success_prompt = function(message, time)
  {
      prompt(message, 'alert-success', time);
  };

  // 失败提示
  var fail_prompt = function(message, time)
  {
      prompt(message, 'alert-danger', time);
  };

  // 提醒
  var warning_prompt = function(message, time)
  {
      prompt(message, 'alert-warning', time);
  };

  // 信息提示
  var info_prompt = function(message, time)
  {
      prompt(message, 'alert-info', time);
  };

</script>


<!-- fancybox -->
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>





  <script>setLoadingBarProgress(100);</script>
  <!-- 浏览器搞笑标题-->
  <script type="text/javascript" src="/js/funnytitle.js"></script>
  <script>
	var pjax = new Pjax({
		elements: "a",
		selectors: [
			"title",
			".l_body",
			"cover-wrapper",
		]
	})
	function LoadHitoKoto(){
		fetch('https://v1.hitokoto.cn/?c=a')//加载一言
		.then(function (res){
			return res.json();
		})
		.then(function (data) {
			var h_content = document.getElementById('hitokoto-content');
			var h_from = document.getElementById('hitokoto-from');
			h_content.innerText = data.hitokoto; 
			h_from.innerText = "——" + data.from; 
		})
		.catch(function (err) {
			console.error(err);
		})
	}
	function LoadGitalk(){
		$.getScript("/js/gitalk.js", function() {
			var gitalk = new Gitalk({
				clientID: '3834d471f8d5bcc2124c',
				clientSecret: '65eba0180c59c88aaeada1446ed6e55e73ed1861',
				accessToken: '36159b9ee938e02ee4f766fb299f885b4e477dd7',
				repo: 'Sunshine-0215.github.io',
				owner: 'Sunshine-0215',
				admin: ['Sunshine-0215'],
				id: location.pathname,
				language: 'zh-CN',
				distractionFreeMode: ''
			});
			gitalk.render('gitalk-container');
		});
	}
	function LoadMathJax(){
		$.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function() {//渲染mathjax
			MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
			// entry-content是文章页的内容div的class
			var math = document.getElementsByClassName("entry-content")[0];
			MathJax.Hub.Queue(["Typeset",MathJax.Hub,math]);
		});
	}
	function LoadFancybox(){
		$(".article-entry").find("img").each(function () {//渲染fancy box
			var t = document.createElement("a");
			$(t).attr("data-fancybox", "gallery"),
			$(t).attr("href", $(this).attr("src")),
			$(this).wrap(t)
		})
	}
	function LoadWpac(){
		wpac_init = window.wpac_init || [];
		wpac_init.push({widget: 'Rating', id: 21085});//渲染widget pack（点赞系统）
		WIDGETPACK_LOADED=false;
		(function() {
			WIDGETPACK_LOADED = true;
			var mc = document.createElement('script');
			mc.type = 'text/javascript';
			mc.async = true;
			mc.src = 'https://embed.widgetpack.com/widget.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(mc, s.nextSibling);
		})();
	}
    // 开始 PJAX 执行的函数
    document.addEventListener('pjax:send', function (){
		$(".loading").css("display", "block");//加载转圈圈的css
   });

   // PJAX 完成之后执行的函数，可以和上面的重载放在一起
   document.addEventListener('pjax:complete', function (){
		$(".loading").css("display", "none");
		LoadMathJax();
		LoadHitoKoto();
		
			LoadWpac();
		
		LoadFancybox();
		
			LoadGitalk();
		
   });
  </script>

  
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" rel="noreferrer">
	
		<!-- require APlayer -->
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
		<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
		<!-- require MetingJS -->
		<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
		<meting-js
			server="tencent"
			type="playlist"
			id="7507044948"
			fixed=true
			color="#1BCDFC"
			mode="circulation"
			autoplay=false
			volume=0.5
		>
		</meting-js>
	
  
  <script>
	  
		  get_latest_comments("Sunshine-0215/Sunshine-0215.github.io");
	  
  </script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":true,"model":{"scale":1.2,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"superSample":2,"position":"right","width":150,"height":300,"hOffset":0,"vOffset":50},"mobile":{"show":true},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"dialog":{"enable":true,"hitokoto":true},"log":false});</script></body>
</html>
